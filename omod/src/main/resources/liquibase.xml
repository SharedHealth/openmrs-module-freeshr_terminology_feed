<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">

    <changeSet id="BD-201408041330" author="soham" context="setup">
        <comment>Added constraints to concept_reference_source table.</comment>
        <sql>
            ALTER TABLE concept_reference_source ADD UNIQUE (name);
        </sql>
    </changeSet>
    <changeSet id="BD-201411181657" author="neha" context="setup">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from chunking_history;
            </sqlCheck>
        </preConditions>
        <comment>Add chunking history</comment>
        <sql>
            insert into chunking_history (id, chunk_length, start) values (1, 100, 1);
        </sql>
    </changeSet>
    <changeSet id="BD-201412011225" author="angshu" context="setup">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_class where LOWER(name) = 'valueset';
            </sqlCheck>
        </preConditions>
        <comment>Add concept class valueset</comment>
        <sql>
            INSERT INTO concept_class (name, description, uuid, creator, date_created) values ('Valueset', 'FHIR valueset', uuid(), 1, NOW());
        </sql>
    </changeSet>

    <changeSet id="BD-201412031205" author="utsab" context="setup">
        <comment>Add concept procedure</comment>
        <sqlFile splitStatements="false" path="storedProcedures/AddConceptProc.sql"/>
    </changeSet>

    <changeSet id="BD-201412031206" author="utsab" context="setup">
        <comment>Add concept answer procedure</comment>
        <sqlFile splitStatements="false" path="storedProcedures/AddConceptAnswerProc.sql"/>
    </changeSet>

    <changeSet id="BD-201412031207" author="utsab" context="setup">
        <comment>Add concept word procedure</comment>
        <sqlFile splitStatements="false" path="storedProcedures/AddConceptWordProc.sql"/>
    </changeSet>

    <changeSet id="BD-201412031208" author="utsab" context="setup">
        <comment>Set value as concept id procedure</comment>
        <sqlFile splitStatements="false" path="storedProcedures/DeleteConceptProc.sql"/>
    </changeSet>

    <changeSet id="BD-201412031209" author="utsab" context="setup">
        <comment>Add concept description procedure</comment>
        <sqlFile splitStatements="false" path="storedProcedures/AddConceptDescriptionProc.sql"/>
    </changeSet>

    <changeSet id="BD-201412031210" author="utsab" context="setup">
        <comment>Add concept reference map procedure</comment>
        <sqlFile splitStatements="false" path="storedProcedures/AddConceptReferenceMapProc.sql"/>
    </changeSet>

    <changeSet id="BD-201412031211" author="utsab" context="setup">
        <comment>Add concept set members procedure</comment>
        <sqlFile splitStatements="false" path="storedProcedures/AddConceptSetMembersProc.sql"/>
    </changeSet>

    <changeSet id="BD-201412031212" author="utsab" context="setup">
        <comment>Add concept numeric proc</comment>
        <sqlFile splitStatements="false" path="storedProcedures/AddConceptNumericProc.sql"/>
    </changeSet>

    <changeSet id="BD-201412031409" author="utsab" context="setup">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_reference_source where name = 'ICD10-BD';
            </sqlCheck>
        </preConditions>
        <insert tableName="concept_reference_source">
            <column name="name" value="ICD10-BD"/>
            <column name="description" value="ICD10-BD"/>
            <column name="hl7_code" value="ICD10-BD"/>
            <column name="creator" value="1"/>
            <column name="date_created" valueDate=" now()"/>
            <column name="uuid" valueComputed=" uuid()"/>
        </insert>
    </changeSet>

    <changeSet id="BD-201412031412" author="utsab" context="setup">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_reference_source where name = 'SNOMED-BD';
            </sqlCheck>
        </preConditions>
        <insert tableName="concept_reference_source">
            <column name="name" value="SNOMED-BD"/>
            <column name="description" value="Systematized Nomenclature of Medicine Clinical Terms for Bangladesh"/>
            <column name="hl7_code" value="SNOMED-BD"/>
            <column name="creator" value="1"/>
            <column name="date_created" valueDate=" now()"/>
            <column name="uuid" valueComputed=" uuid()"/>
        </insert>
    </changeSet>

    <changeSet id="BD-201412031415" author="utsab" context="setup">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_reference_source where name = 'LOINC';
            </sqlCheck>
        </preConditions>
        <insert tableName="concept_reference_source">
            <column name="name" value="LOINC"/>
            <column name="description" value="These are codes for tests"/>
            <column name="hl7_code" value="LOINC"/>
            <column name="creator" value="1"/>
            <column name="date_created" valueDate=" now()"/>
            <column name="uuid" valueComputed=" uuid()"/>
        </insert>
    </changeSet>

</databaseChangeLog>